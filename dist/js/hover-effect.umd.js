!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("three"),require("gsap/TweenMax")):"function"==typeof define&&define.amd?define(["three","gsap/TweenMax"],t):e.hoverEffect=t(e.THREE,e.TweenMax)}(this,function(U,C){return C=C&&C.hasOwnProperty("default")?C.default:C,function(e){function t(){for(var e=arguments,t=0;t<arguments.length;t++)if(void 0!==e[t])return e[t]}console.log("%c Hover effect by Robin Delaporte: https://github.com/robin-dela/hover-effect ","color: #bada55; font-size: 0.8rem");var n,i,o,r,a,s,f,d,l,u,m,c,p,v=e.parent,g=e.displacementImage,h=e.image1,y=e.image2,x=t(e.imagesRatio,1),F=t(e.intensity1,e.intensity,1),w=t(e.intensity2,e.intensity,1),L=t(e.angle,Math.PI/4),H=t(e.angle1,L),E=t(e.angle2,3*-L),W=t(e.speedIn,e.speed,1.6),V=t(e.speedOut,e.speed,1.2),L=t(e.hover,!0),M=t(e.easing,Expo.easeOut),P=t(e.video,!1);function R(){C.to(c.uniforms.dispFactor,W,{value:1,ease:M,onUpdate:r,onComplete:r})}function T(){C.to(c.uniforms.dispFactor,V,{value:0,ease:M,onUpdate:r,onComplete:r})}v?h&&y&&g?(n=new U.Scene,(i=new U.OrthographicCamera(v.offsetWidth/-2,v.offsetWidth/2,v.offsetHeight/2,v.offsetHeight/-2,1,1e3)).position.z=1,(o=new U.WebGLRenderer({antialias:!1,alpha:!0})).setPixelRatio(2),o.setClearColor(16777215,0),o.setSize(v.offsetWidth,v.offsetHeight),v.appendChild(o.domElement),r=function(){o.render(n,i)},(e=new U.TextureLoader).crossOrigin="",(g=e.load(g,r)).magFilter=g.minFilter=U.LinearFilter,P?((s=function(){requestAnimationFrame(s),o.render(n,i)})(),(P=document.createElement("video")).autoplay=!0,P.loop=!0,P.src=h,P.load(),(f=document.createElement("video")).autoplay=!0,f.loop=!0,f.src=y,f.load(),d=new U.VideoTexture(P),l=new U.VideoTexture(f),d.magFilter=l.magFilter=U.LinearFilter,d.minFilter=l.minFilter=U.LinearFilter,f.addEventListener("loadeddata",function(){f.play(),(l=new U.VideoTexture(f)).magFilter=U.LinearFilter,l.minFilter=U.LinearFilter,c.uniforms.texture2.value=l},!1),P.addEventListener("loadeddata",function(){P.play(),(d=new U.VideoTexture(P)).magFilter=U.LinearFilter,d.minFilter=U.LinearFilter,c.uniforms.texture1.value=d},!1)):(d=e.load(h,r),l=e.load(y,r),d.magFilter=l.magFilter=U.LinearFilter,d.minFilter=l.minFilter=U.LinearFilter),m=v.offsetHeight/v.offsetWidth<(u=x)?(a=1,v.offsetHeight/v.offsetWidth/u):(a=v.offsetWidth/v.offsetHeight*u,1),c=new U.ShaderMaterial({uniforms:{intensity1:{type:"f",value:F},intensity2:{type:"f",value:w},dispFactor:{type:"f",value:0},angle1:{type:"f",value:H},angle2:{type:"f",value:E},texture1:{type:"t",value:d},texture2:{type:"t",value:l},disp:{type:"t",value:g},res:{type:"vec4",value:new U.Vector4(v.offsetWidth,v.offsetHeight,a,m)},dpr:{type:"f",value:window.devicePixelRatio}},vertexShader:"\nvarying vec2 vUv;\nvoid main() {\n  vUv = uv;\n  gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}\n",fragmentShader:"\nvarying vec2 vUv;\n\nuniform float dispFactor;\nuniform float dpr;\nuniform sampler2D disp;\n\nuniform sampler2D texture1;\nuniform sampler2D texture2;\nuniform float angle1;\nuniform float angle2;\nuniform float intensity1;\nuniform float intensity2;\nuniform vec4 res;\nuniform vec2 parent;\n\nmat2 getRotM(float angle) {\n  float s = sin(angle);\n  float c = cos(angle);\n  return mat2(c, -s, s, c);\n}\n\nvoid main() {\n  vec4 disp = texture2D(disp, vUv);\n  vec2 dispVec = vec2(disp.r, disp.g);\n\n  vec2 uv = 0.5 * gl_FragCoord.xy / (res.xy) ;\n  vec2 myUV = (uv - vec2(0.5))*res.zw + vec2(0.5);\n\n\n  vec2 distortedPosition1 = myUV + getRotM(angle1) * dispVec * intensity1 * dispFactor;\n  vec2 distortedPosition2 = myUV + getRotM(angle2) * dispVec * intensity2 * (1.0 - dispFactor);\n  vec4 _texture1 = texture2D(texture1, distortedPosition1);\n  vec4 _texture2 = texture2D(texture2, distortedPosition2);\n  gl_FragColor = mix(_texture1, _texture2, dispFactor);\n}\n",transparent:!0,opacity:1}),g=new U.PlaneBufferGeometry(v.offsetWidth,v.offsetHeight,1),p=new U.Mesh(g,c),n.add(p),L&&(v.addEventListener("mouseenter",R),v.addEventListener("touchstart",R),v.addEventListener("mouseleave",T),v.addEventListener("touchend",T)),window.addEventListener("resize",function(e){m=v.offsetHeight/v.offsetWidth<u?(a=1,v.offsetHeight/v.offsetWidth/u):(a=v.offsetWidth/v.offsetHeight*u,1),p.material.uniforms.res.value=new U.Vector4(v.offsetWidth,v.offsetHeight,a,m),o.setSize(v.offsetWidth,v.offsetHeight),r()}),this.next=R,this.previous=T):console.warn("One or more images are missing"):console.warn("Parent missing")}});